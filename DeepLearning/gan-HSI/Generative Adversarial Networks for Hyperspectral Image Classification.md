重要点：

In our networks, any pooling layer is replaced with stride convolutions (discriminator) and fractional-strided convolutions (generator).

在我们的网络中，任何池化层都被步幅卷积（鉴别器）和分数步幅卷积（生成器）替换。





全文翻译：

### abstract

摘要——生成对抗网络（GAN）通常包含一个生成网络和一个判别网络，相互竞争。 GAN 已经在各种应用中展示了它的能力。本文首次探讨了 GAN 在高光谱图像 (HSI) 分类中的有用性和有效性。在所提出的 GAN 中，卷积神经网络 (CNN) 旨在区分输入，而另一个 CNN 用于生成所谓的假输入。前面提到的 CNN 是一起训练的：生成式 CNN 尝试生成尽可能真实的假输入，而判别式 CNN 尝试对真实和假输入进行分类。这种对抗性训练提高了判别性 CNN 的泛化能力，这在训练样本有限的情况下非常重要。具体来说，我们提出了两种方案：1）精心设计的 1D-GAN 作为光谱分类器和 2）稳健的 3D-GAN 作为光谱-空间分类器。此外，生成的对抗样本与真实训练样本一起使用，以微调判别性 CNN，从而提高最终分类性能。所提出的分类器在三个广泛使用的高光谱数据集上进行：萨利纳斯、印第安纳松树和肯尼迪航天中心。获得的结果表明，与最先进的方法相比，所提出的模型提供了具有竞争力的结果。此外，提出的 GAN 在遥感领域为 HSI 分类的挑战性任务开辟了新的机会，也揭示了基于 GAN 的方法在分析这种复杂和固有的非线性数据方面的巨大潜力。



### INTRODUCTION

这些数据被认为是地球观测的宝贵信息来源，为开发新的数据处理技术带来了挑战和机遇[1]。 高光谱图像 (HSI) 的分类是众多应用程序的关键步骤，它试图为场景中的每个像素分配一个特定的类别。 HSI 分类被广泛应用于城市发展、土地变化监测、场景解释和资源管理等领域。 在高光谱数据处理技术中，分类是遥感界最活跃的话题之一[2]。

在过去的几十年中，大多数已应用于机器学习社区的监督方法都已被用于 HSI 分类。 一般来说，有两种数据分类方法：光谱分类器和光谱-空间分类器。

高光谱数据通常包含同一场景的数百个光谱通道，提供了丰富的光谱信息。 传统的光谱分类算法通常包括 K 最近邻 (KNN)、最大似然、神经网络和逻辑回归 [3]。 这些算法中的大多数都严重遭受所谓的维度灾难（休斯现象）[4]。 支持向量机（SVM）在训练样本数量方面对高维的敏感性较低，不太可能受到休斯现象的影响。 此外，与其他广泛使用的监督技术相比，基于 SVM 的分类器通常在有限数量的训练样本可用时获得良好的分类性能 [5]、[6]。 在本世纪的第一个十年中，基于 SVM 的光谱分类器被认为是高光谱社区中最先进的方法。



随着传感器和成像系统的进步，高光谱数据的空间分辨率越来越精细。借助可以通过过滤或分割方法等多种方法提取的空间信息，可以显着提高分类性能。在这些方法中，形态学轮廓已被广泛用于提取 HSI 的空间特征（通常随后是 SVM 或随机森林以获得生成的分类图）[7]。基于形态算子的高光谱数据特征提取已经开发了许多扩展，这表明形态剖面仍在进一步发展中[8]。另一方面，多核学习已被应用于高光谱数据分类，因为它具有以有效方式处理异构光谱和空间特征的强大能力[9]。光谱-空间分类方法被认为是 HSI 分类的主流。近年来，人们提出了许多关于高光谱数据的光谱-空间分类的方法。例如，在[10]中，提出了一种结合稀疏表示和马尔可夫随机场的方法。该方法利用马尔可夫随机场探索空间相关性，显着提高了分类性能。此外，[11] 中提出了一种新的基于判别分析的光谱空间分类器用于 HSI 分类。所提出的方法从光谱和空间域中学习了一个有代表性的子空间，并产生了良好的分类性能。

大多数传统的光谱和光谱空间分类器没有以“深度”方式对高光谱数据进行分类。 在 [12] 中，证明了线性 SVM 和逻辑回归等分类器可以归因于单层分类器，而决策树或带核的 SVM 被认为具有两层。 包含两个或多个隐藏层的深度模型倾向于提取输入数据的不变和判别特征。 近年来，深度学习方法在图像分类、语言处理和语音识别等广泛的研究领域得到了积极的研究[13]、[14]。 最近，深度学习也被用于遥感数据处理，包括 HSI 分类。 可以在 [15] 中找到对基于深度学习的遥感数据方法的调查。

2014 年，一种基于深度学习的方法，堆叠自动编码器，被提出用于高光谱特征提取和分类 [16]。 深度信念网络是另一种深度模型，也被引入和修改用于 HSI 分类 [17]、[18]。

[19] 和 [20] 中的上述方法是光谱分类器。 为了同时利用 HSI 的空间和光谱信息，已经提出了一些基于深度 CNN 的光谱-空间分类器 [21]、[22]。 例如，在 [22] 中，基于主成分分析 (PCA)、深度 CNN 和逻辑回归的框架用于 HSI 分类。 HSI 本质上是 3-D 数据，因此设计 3-D CNN 以有效提取 HSI [23]、[24] 的光谱-空间特征是合理的。 另一方面，CNN 可以与其他技术相结合，例如稀疏表示方法和 Gabor 滤波。 在 [25] 中，CNN 之后是稀疏表示以细化学习到的特征。 最近，引入了一种基于 Gabor 滤波和 CNN 相结合的方法来提取 HSI 的特征，从而提高了性能 [26]。

此外，还有一些新类型的深度模型也被研究用于 HSI 分类。 最近，已经为 HSI 分类提出了一种新的深度字典学习，它在有限的训练样本条件下显示了它的能力 [27]。

尽管使用基于深度学习的方法在 HSI 分类方面取得了很大进展，但深度模型通常面临一个严重的问题，即过度拟合。这个问题背后的原因是基于深度学习的方法需要训练大量的可学习参数，这需要大量的训练样本。当训练样本的数量有限时，问题变得很严重。不幸的是，训练样本的有限可用性是遥感界的常见情况，因为收集此类数据要么耗时要么昂贵。如果没有足够的训练样本可用，深度模型通常会过度训练，这意味着在训练阶段表现良好但在测试阶段相对较差。因此，需要新的有效的深度模型训练策略来解决过度拟合的问题。 [本文研究的生成对抗网络 (GAN) 就是其中一种策略。] 实际上，GAN 的生成器网络可以看作是一种正则化方法，它可以在很大程度上缓解过拟合现象。

GAN 是一种新型模型，通常包含一个生成模型 G 和一个判别模型 D [28]。 模型 G 和 D 以对抗方式进行训练，其中 G 尝试生成尽可能真实的虚假输入，而 D 尝试对真实和虚假输入进行分类。 在这个对抗博弈中，双方都希望得到优化的结果（即 D 可以达到最好的分类结果，G 可以生成与真实数据分布最相似的假数据）。 通过两个网络的对抗方式和竞争，判别器的训练过程将持续有效地进行，而不是在我们使用有限数量的训练样本时立即陷入过度拟合。

此外，GAN 生成的样本可以用作虚拟样本。 虚拟样本的正确使用提高了分类性能。 在本文中，生成的样本用于提高分类精度，实验结果证明了使用此类样本的有效性。

由于 CNN 的优势，深度卷积 GAN 非常适合图像数据处理 [29]。 GAN 可用于多种应用，例如数据合成、风格迁移以及图像超分辨率和分类 [30]。
在本文中，首次探索了使用 GAN 进行高光谱数据分类。 在 GAN 的帮助下，深度 CNN 在分类精度方面取得了更好的性能，并且可以大大缓解 CNN 引发的过拟合问题。 提出了两个框架，1D-GAN 和 3D-GAN，用于 HSI 分类，这两个框架获得的分类结果表明，即使在训练样本有限的情况下，我们的 GAN 也优于传统的 CNN。 更详细地说，本文的主要贡献总结如下。



- 本文首次探讨了使用 GAN 进行高光谱数据处理。 包括 1-D 光谱和 3-D 光谱-空间补丁在内的对抗样本由精心设计的 GAN 生成。
- 为 HSI 分类提出了两个 GAN 框架，包括光谱分类器和光谱空间分类器。 该框架使用精心设计的 CNN 对 HSI 进行分类，并通过正则化技术采用对抗性训练。
- 对抗样本首次用于 HSI 分类，研究它以微调上述 GAN 以提高分类性能。在可用的训练样本有限的情况下，在三个众所周知的高光谱数据集上测试了所提出的方法。

本文的其余部分安排如下。 第二节介绍了 GAN 的背景。 第三节介绍了所提出的 GAN 框架的细节，包括用于 HSI 分类的光谱和光谱空间架构，以及用于分类的对抗样本的介绍。 实验结果的细节在第四节中报告。 在第五节中，提出了结论和讨论。



### BACKGROUND

​	机器学习中的监督学习方法通常可以分为两部分：生成方法和判别方法。 生成方法涉及从数据样本中学习分布参数，并且它们可以根据学习的模型生成新样本。 通常，生成方法计算真实数据的显式或隐式变量的分布假设。 然后，他们可以通过学习到的假设生成新数据，这些假设与真实数据具有相似的分布。

​	Goodfellow等人提出的GAN。 [28] 是一种训练生成模型的新方法，也是一种很有前途的分类器训练方法。 通常，GAN 由生成网络 G 和判别模型 D 两部分组成。生成器 G 可以捕捉真实数据的潜在分布并输出新数据，而判别器 D 是一个二元分类器，可以判断输入样本是否真实 或不。 GAN 中的信息流是来自一个模型生成器 G 的前馈传递，G 生成假数据到第二个模型鉴别器 D，后者评估第一个模型的输出。 GAN 的架构如图 1 所示。

​	为了学习生成器在数据 x 上的分布 pg，我们假设真实样本配备了数据分布 p(x)，并且输入噪声变量具有先验 p(z)。 生成器接受随机噪声 z 作为输入，并生成到数据空间 G(z) 的映射。 D(x) 估计 x 是训练数据中真实样本的概率 [31]。 在优化过程中，判别器 D 被训练以最大化 log(D(x))，这是将正确标签分配给正确源的概率，同时生成器 G 被训练以最小化 log(1 - D(G(z)) ）。 因此，优化的最终目的是解决极小极大问题

![image-20220309214642975](https://cdn.jsdelivr.net/gh/dlagez/img@master/image-20220309214642975.png)

其中 E 是期望算子。 通过计算和评估发现，当判别器 D 具有高概率分布的真实样本时，D 中的梯度可能会消失并导致训练过程停止。 当判别器的分类精度很高时，为了确保生成器具有适当的梯度，通常制定生成器的损失函数以最大化将样本分类为真的概率，而不是最小化样本被分类为假的概率 [30]。 因此，修改后的损失函数可以写成如下优化形式：

![image-20220309214705594](https://cdn.jsdelivr.net/gh/dlagez/img@master/image-20220309214705594.png)

G 的参数更新是基于 D 的反向传播，而不是直接使用真实数据样本。 此外，不要求潜在代码具有任何特定的维度，也不要求生成网络是可逆的。 GAN 可以学习仅在靠近数据的薄流形上生成点的模型，因此 GAN 框架可以训练任何类型的生成器网络。



一方面，当 G 和 D 都是多重感知器时，对抗模型是最直接的 [28]。另一方面，浅乘感知器通常在处理复杂数据方面能力有限。最近，深度学习方法取得了巨大的成功，它们可以构建一个具有多层的网络，而不是浅层的网络层连接[33]。因此，他们可以利用非线性映射能力并捕获输入数据的更多关键特征（即，特别是在处理复杂且固有的非线性数据时）[34]、[35]。作为一种特殊类型的基于深度学习的方法，卷积网络（即 CNN）[36] 受到神经科学 [37] 的启发，利用了两种重要的策略，使其不同于其他深度学习方法。这两种策略是本地连接和共享权重。更详细地说，在 CNN 中，通过考虑附近神经元之间的局部连通性来探索局部相关信息，而不是像其他深度方法中的所有神经单元的完全连接。在这种情况下，CNN 可以降低利用数据特征的计算复杂性和冗余。特别是 CNN 可以缓解深度学习过程中的过拟合现象。最近，深度方法和 CNN 在 HSI 分类和特征提取方面表现出了优异的性能 [23]。



尽管 GAN 在各个方面都显示出其有前途的用途，但由于其对抗性思想 [28]，它们也存在稳定性问题。为了解决这个问题，已经开发了一些稳定 GAN 训练过程的技术。在这些方法中，卷积网络可以在一定程度上解决不稳定性问题。最近，在 [29] 中提出了在 G 和 D 中使用深度卷积网络的深度卷积生成对抗网络（DCGAN）架构。将均匀噪声分布 z 和类别标签 c 分别作为输入和输出的生成器 G 可以重新整形为 3-D 张量。鉴别器 D 具有与普通 CNN 相似的架构，只是池化层被跨步卷积取代，并且所有激活函数都是泄漏校正线性单元 [38]。尽管 GAN 在图像合成 [39] 和许多其他方面 [40] 方面表现出可观的性能，但作为无监督生成模型，原始 GAN 的 D 网络仅估计输入样本是真还是假。因此，它们不适用于多类图像分类的目的。最近，GAN 的概念已扩展为具有半监督方法的条件模型。奥登纳等人。 [41] 提出了半 GAN，其真实训练数据的标签被导入判别器 D。

此外，条件 GAN 需要 G 和 D 的一些额外信息，其中额外信息可以是类标签或其他数据模式 [42]。 因此，条件 GAN 可以利用生成对抗网络来生成特定标签。 此外，Odena 等人。 [43]提出了辅助分类器GAN（AC-GAN），可用于图像分类，其鉴别器D被修改为可以输出多类标签概率的softmax分类器。



### PROPOSED METHOD

建议方法的框架

我们的网络是根据 ACGAN 的理论来塑造的，同时修改目标函数以考虑正确来源的可能性和正确 HSI 类的可能性。参数根据多分类损失进行优化，因此它们可以比传统的 GAN 更合适地优化损失函数。标记信息作为生成器和判别器的输入，判别器 D 包含一个辅助解码器网络，可以输出各自的训练数据标签。当然，额外标签信息可以同时利用判别器 D 的分类能力和生成器 G 的生成能力。我们方法的架构如图 2 所示。
从原始 GAN 可以看出，在训练过程中，判别器 D 接收生成器 G 生成的真实训练数据和假数据，并输出概率分布 P(S|X) = D(X)。因此，D 网络的目标是尝试最大化正确源的对数似然

同样，G网络的目的是试图尽量减少相同数量。

在网络中，我们可以看到生成器 G 也接受 HSI 类标签 c∼pc； 除了噪声 z 之外，G 的输出可以由 Xfake = G(z) 定义。 具有相应类标签的真实训练数据和由 G 生成的假数据被视为判别器 D 的输入。源 P(S|X) 上的概率分布以及类标签 P (C | X ) 上的概率分布是 输入网络 D. 目标函数包含两部分：正确输入数据源 Ls 的对数似然和正确类标签 Lc 的对数似然

1D-GAN

![image-20220310102910128](https://cdn.jsdelivr.net/gh/dlagez/img@master/image-20220310102910128.png)

1D-GAN的主要框架如图3所示，该框架仅基于HSI光谱特征构建，其中所有输入噪声和训练数据都是光谱矢量。

由于原始HSI中有数百个波段可用，这意味着输入尺寸高，因此很难训练发生成器G（即训练阶段不稳定）。换句话说，由于冗余性高，生成器无法有效地模仿真实数据。因此，我们基于PCA[44]提取HSI的光谱特征。PCA可以通过将光谱维度降低到合适的比例来压缩整个图像，这是制定健壮的GAN的关键一步。

相关的是，为了促进发电机在捕捉关键特征和生成尽可能逼真的样本方面发挥卓越的能力，并保存原始HSI波段最重要的光谱信息，我们保留了10个主要组件，其中包含99.99%的输入能量。

在图 3 中，我们展示了以 Salinas 数据集为输入的 1D-GAN 框架。 从图 3 可以看出，G 接收噪声 z 和标签 c 作为输入，而 D 接收带有标签 c 的真实谱向量 x 和一些批次的假谱向量 G(z) 作为输入。 然后，通过 D 网络，可以得到包括类标签和源标签的最终结果。 在我们的网络中，任何池化层都被步幅卷积（鉴别器）和分数步幅卷积（生成器）替换。



### 3D-GAN

![image-20220310165813450](https://cdn.jsdelivr.net/gh/dlagez/img@master/image-20220310165813450.png)

3D-GAN的主要框架如图4所示.在3D-GAN中，该网络有效地提取光谱空间特征，从而实现更好的分类性能。在这里，我们只描述了拟议的3D-GAN的特殊部分。与仅使用HSI光谱信息的1D-GAN不同，除了本节中的光谱特征外，还考虑了空间特征。

PCA将光谱带的数量减少到三个组件，PCA通过将数据维度缩小到适当的比例来压缩整个图像，同时保留空间信息。由于PCA，计算复杂度大幅降低，稳定GAN训练的过程真的很重要。在3D-GAN中，生成器接受噪声作为输入，并将其形状转换为与光谱域中有三个主要组件的真实数据相同的大小。然后，反歧视者接受真实数据或生成的假样本作为输入数据，并使用乙状体分类器给出真实和假分类结果，使用softmax分类器给出分类图。以均匀噪声分布z为输入的GAN的第一层只是矩阵乘法。然后将结果重塑为张量，并用作卷积堆栈的开始。在拟议的框架中，我们用多色方块表示高光谱地面标签，但用灰色正方形表示源标签。

在3D-GAN中，与1D-GAN中的基本分配一样，池层被分层卷积（在辨别器中）和分数条纹卷积（在发电机中）取代。此外，生成器和鉴别器都使用批处理规范化，并删除完全连接的隐藏层。

### *D. Generative Adversarial Samples for Classification*

现在让我们考虑一下，GAN由发电机和鉴别器组成。上面讨论了鉴别器的分类能力。另一方面，使用发电机的假样品也可能在准确性方面提高最终分类结果。事实上，当鉴别器无法区分真实数据和合成假数据时，我们也可以得出结论，G的生成能力优于D。因此，整个对抗网络在理论上实现了全球最优[28]。

本文生成的假样本可以被视为增加训练样本数量的增强数据[45]。然后，将假样本和真实样本都输入网络，以优化网络。让我们假设原始数据集在网络训练期间有N类。首先，每个生成的样本都通过网络转发，并通过获取概率预测矢量的最大值分配一个标签。因此，这些假样本可用于使用这些标签在网络中进行培训。此外，生成的样本不属于任何一类真实样本。由于真实样本和生成样本的差异，然后创建一个新的类标签（即N+1），每个假样本都具有这个新标签。本文采用这种方法将N+1分配给假样品的标签。在本文的实验部分，我们通过假色地图定性地可视化对手样本。



### EXPERIMENTAL RESULTS

*Data Description*

在我们的研究中，采用了三种广泛使用的具有不同环境背景的高光谱数据集来验证所提出的方法。他们在加利福尼亚州（萨利纳斯）的萨利纳斯山谷、佛罗里达州肯尼迪航天中心（KSC）上被俘，和印第安纳州西北部印度松树试验区（印度松树）上的混合植被地点。

第一个数据集Salinas是由Salinas Valley上空的224波段机载可见/红外成像光谱仪（AVIRIS）传感器收集的。可用数据集由512×217像素和204个波段组成[在删除低信噪比（SNR）波段后]，可用的地面参考地图涵盖16个感兴趣的类别。HSI因具有高空间分辨率（3.7米像素）而受到特征性的影响。图中演示了假彩色复合图像和相应的地面参考地图5.

第二个数据集由美国宇航局AVIRIS仪器在KSC上空捕获。这里它被称为KSC数据集。KSC数据集的高度约为20公里，空间分辨率为18米。该数据集由512×614像素组成。在去除吸水和低信噪比带后，使用176个波段绘制相应的假色复合图。在分类中，为网站定义了13个类。图6演示了KSC数据集的类和相应的假色复合地图。

第三组数据集是AVIRIS收集的印第安纳州西北部印度松树试验区（印度松树）上的混合植被地点。该数据集由一架飞行的飞机获得，尺寸为145像素×145像素，波长范围为0.4-2.5微米，波段为220个频段。假彩色图像如图7（a）所示。

通过去除吸水带，带的数量减少到 200。 地面参考图中提供了 16 种不同的土地覆盖类别，如图 7 所示。

对于所有三个数据集，标记样本被分成两个子集，包含训练样本和测试样本，详细信息列于表 I-III。 在 GAN 的训练过程中，我们使用 200 个真正有限的训练样本来学习每个神经元的权重和偏差，并使用 100 个训练样本来指导正确架构的设计，从而可以识别网络是否过拟合或 不是。 在测试过程中，数据集中的所有样本都用于估计训练好的网络的能力。 这对于设计正确的卷积网络很重要，我们可以使用测试样本来评估最终的分类性能。

*Classification Results for 1D-GAN*

在这个实验中，我们的网络也与之前用于 HSI 特征提取和分类的其他方法（如原始 CNN）进行了比较，以验证分类结果的质量。训练和测试数据是在整个数据集中随机选择的，每个数据集只使用 200 个训练样本，我们的方法将 epoch 设置为 500。考虑到 G 和 D 都需要在每个 epoch 中进行训练这一事实，GAN 与其他网络相比具有相对更高的计算复杂度。分类结果以平均值±标准差的形式给出。 1D-GAN 框架仅基于 HSI 光谱特征提取构建。因此，所有的输入噪声和训练数据都是谱向量。首先，通过 PCA 将每个数据集中的训练数据光谱带数量减少到 10 个。发送到生成器网络的噪声z的大小为1×1×1，然后通过生成器G的分数步长卷积转换为10×1×1。然后，将生成的假样本和真训练样本导入到判别器 D，可以给出对应的图像标签 c 和源标签 s。每个数据集的 1D-GANs 和 PCA-CNN 的主要架构如表 IV 所示，表 IV 所示的 n_class 表示每个数据集的类数















