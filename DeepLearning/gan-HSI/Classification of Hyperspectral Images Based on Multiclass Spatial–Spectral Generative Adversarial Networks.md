### Abstract

生成对抗网络（GAN）以通过对抗程序训练生成器和鉴别器来生成样本而闻名。对于高光谱图像分类，样本的收集总是很困难。然而，直接将GAN应用于高光谱图像分类存在两个问题。

- 一是生成的样本缺乏判别信息。同时，判别器没有多分类的辨别能力。
- 另一个是，需要在高光谱图像分类中同时考虑空间和光谱信息

To address these problems, a novel multiclass spatial–spectral GAN (MSGAN) method is proposed

在MSGAN中，设计了两个生成器来生成分别包含空间和光谱信息的样本，并设计了鉴别器来提取联合空间光谱特征并输出多类概率。此外，还定义了多类的新对抗目标。判别器旨在以相同的概率预测属于真实类的训练样本和属于所有类的生成样本。

The generators are devised to make the discriminator mistake.

By adversarial learning between the discriminator and gen- erators, the classification performance of the discriminator is promoted with the assistance of discriminative generated samples

高光谱图像的实验结果表明，与几种最先进的方法相比，特别是在有限的训练样本下，该方法实现了令人鼓舞的分类性能。

### I. INTRODUCTION

高光谱传感器的发展是遥感领域的重大突破。 高光谱传感器同时收集数百个窄且连续的光谱带中的图像，波长跨越可见光到红外光谱。在高光谱图像中，高光谱分辨率提高了描述和区分有趣的土地覆盖类别的能力。如今，高光谱图像已广泛应用于各个领域，如农业[2]、军事[3]和天文学[4]。

该分类是高光谱图像不同应用中常用的技术。分类任务涉及两个关键问题，合适的特征表示和有效的分类器设计[5]。传统的分类方法通常单独完成它们。在高光谱图像的分类中，高维光谱带通常会导致“休斯现象”[6]。因此，高光谱图像中的特征表示侧重于将原始高维数据转换为适当的低维空间，如主成分分析（PCA）[7]、局部保存投影[8]、稀疏图学习[9]、非参数加权特征提取[10]和判别式局部度量学习[11]。提出了一系列空间光谱特征提取方法，如三维Gabor滤波器[12]和三维形态剖面图[13]。[14]提出了一种新的对照随机采样策略，为空间光谱高光谱图像分类方法提供更客观、更准确的评估。[15]提出了一种新的局部协方差矩阵表示方法，用于捕获光谱相关和空间上下文信息，用于HSI的空间光谱特征提取。[16]设计了涉及局部空间窗口光谱协方差的多尺度协方差图，以获取空间光谱信息。[17]提出了一种新的灭绝剖面融合方法，支持将灭绝剖面图内部和之间的信息用于HSI分类。高光谱图像的代表性分类器包括k近邻[18]、逻辑回归（LR）[19]和支持向量机（SVM）[20]。在这些方法中，支持向量机通过最大化不同类之间的利润率来显示出色的性能。提出了一些改进的 SVM 方法，例如 Laplacian SVM [21]、自定义内核 SVM [22] 和并行多类 SVM [23]。 提出了一种新的基于 SVM 的带权重策略 [24]，以最大化类间距离并提高分类性能。



在过去的十年里，基于深度学习的方法在高光谱图像分类方面显示了巨大的潜力。与上述传统分类方法[7]-[24]相比，基于深度学习的方法提取分层特征并同时训练分类器。在 [25] 中，提出了一种用于高光谱图像分类的深度堆叠自动编码器（SAE）方法，该方法结合了基于 PCA 的降维、分层特征提取和 LR 分类。 SAE 的变体包括稀疏 SAE [26]、去噪 SAE [27] 和拉普拉斯 SAE [28]。[29]通过层层学习受限的玻尔兹曼机器网络，构建了一个深度信念网络（DBN），用于高光谱图像分类。这两种深度学习网络可以对高光谱图像中的局部散射变化提取非线性和不变特征[25]。然而，这些网络中的完全连接导致了许多参数。与SAE和DBN相比，卷积神经网络（CNN）[30]使用本地连接提取空间信息和权重共享来减少参数数量。由于这一优势，出现了一系列用于高光谱图像分类的CNN方法[31]-[33]。然而，CNN 方法 [31]-[33] 的性能很大程度上取决于训练样本的数量。 一般来说，高光谱图像中训练样本的采集比较困难。在[34]中，提出了一种像素对CNN（PPF-CNN）方法，通过重组和重新标记现有培训样本来扩展培训集。利用生成模型的样本生成也可以缓解样本量小的问题。



最近，一个具有代表性的生成模型，即生成对抗网络（GAN）[35]，由于其生成高质量样本的能力，吸引了越来越多的关注度。**GAN由两个网络组成，分别称为生成器和反歧视者。鉴别器旨在确定其输入是来自生成的还是来自真实样本，而生成器旨在使鉴别器出错。发电机和鉴别器交替优化对抗目标**（用来描述gan）。开发了一系列改进的GAN方法[36]-[43]。一些方法专注于提供GAN的网络结构，如深度卷积GAN（DCGAN）[36]、拉普拉斯GAN[37]和生成循环对抗网络（GRANs）[38]。DCGAN使用CNN构建网络，没有池层和完全连接层。拉普拉斯GAN在拉普拉斯金字塔结构中使用卷积网络的级联。与DCGAN和Laplacian GAN不同，GRAN通过循环反馈循环构建生成器。其他人专注于解决GAN模式崩溃的问题。发电机以随机噪声为输入，这很容易导致无法控制的训练。一些额外的信息被添加到生成器的输入中，例如条件GAN[39]和最大化GAN[40]的信息。



通过对抗性学习，这些GAN方法[35]-[43]可以有效地生成样本。但由于这些方法的判别器缺乏多类判别能力，这些方法不能直接用于分类。为了实现高光谱图像的分类，提出了一些基于GAN的网络作品[44]-[46]。[44]提出了一种基于GAN的半监督学习方法。它的缩写为HSGAN。在HSGAN中，首先使用无标签训练样本来训练1DGAN。然后，使用带标签的训练样本对经过训练的鉴别器进行微调以进行分类。但HSGAN基于1DGAN，它没有充分利用空间信息。

[45]提出了一种用于高光谱图像分类的3DGAN方法。3DGAN [45]以简化的方式实现。只有三个主要组合作为3DGAN的输入保留。卷积实际上不会在光谱中滑动。在3DGAN中，尽管乙状体和软最大分类器都应用于鉴别器D。G和D的目标函数在二进制乙状乙状分类器分支中是对抗性的，在soft-max分类器分支中不是对抗性的。对抗性学习无法有效提高D的多类判别能力。因此，应用GAN提取空间光谱特征并同时实现高光谱图像的多类分类仍然是一个具有挑战性的主题。



本文提出了一种新的多类空间光谱GAN（MSGAN）方法来进行高光谱图像分类。在MSGAN中，两台发电机G1和G2旨在通过一维移调卷积网络（1D-TCN）生成光谱，并通过2D-TCN生成空间补丁。分别。鉴别器旨在使用1D CNN和2D CNN从光谱和空间补丁中提取联合空间光谱特征，并通过soft-max分类器输出多类概率。判别器的目标是预测属于真实类之一的训练样本的输入，以及属于所有类的生成器G1和G2的输入，概率相同。在生成器中，对抗目标旨在使鉴别器错误。多班的对抗性学习在鉴别生成的样本的帮助下，提高了鉴别器的分类性能。最后，训练有素的鉴别器直接用作分类器。此外，条件标签信息附加到发电机的输入中，**并使用批量归一化策略**[47]来避免模式崩溃并提高MSGAN的稳定性。

本文的主要贡献可以总结如下：

- MSGAN 实现了基于 GAN 的端到端多分类。 它将空间和光谱样本生成、联合空间-光谱特征提取和分类结合到一个统一的优化过程中。
- MSGAN定义了发电机和鉴别器之间多类的对抗性反对。与3DGAN[40]相比，MSGAN利用多类对抗性学习来进一步提高鉴别者的多类鉴别能力。
- 针对高光谱图像中 3-D 数据立方体的特点，MSGAN 不仅生成具有 1-D 光谱和 2-D 空间块的样本，而且还提取了空间-光谱联合特征。 与 HSGAN [44] 相比，MSGAN 实现了基于 GAN 的端到端分类，并利用空间信息来提升分类性能。
- MSGAN 通过充分利用多类生成样本和对抗性学习来缓解高光谱图像的小尺寸问题。

### REVIEW OF GENERATIVE ADVERSARIAL NETWORKS

在介绍拟议的MSGAN方法之前，我们首先简要回顾了GAN的架构。受博弈论的纳什均衡[48]的启发，Goodfellow等人[35]提出了GANs。如图所示1。GAN包括两个网络，一个称为生成器G，另一个称为鉴别器D。G的目标是学习真实数据x的分布pdata，并生成受此分布的数据。G将随机的高斯噪声z作为输入，并将z映射到G（z）。鉴别器D的输入包括真实数据x和生成的数据G（z）。D的输出表示D的输入来自真实数据而不是生成数据的概率。简而言之，G想愚弄D并犯错，D想尽可能准确地区分真实数据和生成的数据。

GAN的优化过程是找到G和D之间的纳什平衡。这是一个最小最大博弈问题。



![image-20220315094506992](https://cdn.jsdelivr.net/gh/dlagez/img@master/image-20220315094506992.png)

通过采用发电机G和鉴别器D之间的交替优化策略来实施GAN的训练



![image-20220315094738341](https://cdn.jsdelivr.net/gh/dlagez/img@master/image-20220315094738341.png)

在一个迭代中，在G网络被固定的情况下，D网络被优化了K次。在D网络固定的情况下G网络被优化了一次。在对抗的过程中，G网络和D网络相互促进对方。在多次迭代之后达到全局最优。其中pg表示G学到的分布。在这种情况下，G学习真实数据的分布。同时，D区分真实数据和生成数据的能力得到了提高。



### III. MULTICLASS SPATIAL–SPECTRAL GAN

拟议MSGAN方法的流程图如图所示。2.如图所示。2、MSGAN由三个部分组成：

1. 通过发电机G1生成基于1D-TCN的频谱，
2. 通过发电机G2生成基于2D-TCN的空间补丁，联合空间光谱特征提取，
3. 以及通过鉴别器D进行分类。



![image-20220315095516937](https://cdn.jsdelivr.net/gh/dlagez/img@master/image-20220315095516937.png)

在高光谱图像中，公式代表像素的光谱。从高光谱图像中获得相应的 `w × w` 像素的空间邻域块，并在应用 `PCA` 提取几个主成分后用公式表示。`Xspe`用于构成训练样本。N是训练样本的数量。表示训练样本对应的 `one-hot` 编码标签。



![image-20220315100505338](https://cdn.jsdelivr.net/gh/dlagez/img@master/image-20220315100505338.png)

在样本生成阶段，随机噪声 `z1 `和 `z2 `分别用作` G1 `和 `G2 `的输入。 此外，将类标签` y` 添加到输入中以稳定生成器` G1` 和` G2` 并避免模式崩溃。训练过后。在`G1（Z1，y）`被`1D-TCN`、`G2（Z2， y）`被`2D-TCN`生成之后，多类光谱和空间补丁被生成。



在特征提取和分类阶段，带有`soft-max`层的判别器D提取联合空间光谱特征并实现多分类。判别器旨在预测属于多个类之一的训练样本，并以相同的概率从属于所有类的G1和G2生成样本。经过对抗性培训，直接使用判别器D来实施多分类。



#### A .MSGAN中通过G1和G2生成基于1D-TCN的频谱和基于2D-TCN的空间补丁

发电机G 1和G2用于生成分别包含光谱和空间信息的多类光谱和空间补丁。如图3所示，G1和G2发电机都由TCN[49]制造。具体而言，一维TCN用于生成光谱G1（z1，y），二维TCN用于生成空间补丁G2（z2，y）。额外的标签信息y附加到发电机G1和G2的输入中，以避免潜在的模式崩溃。



![image-20220315102527410](https://cdn.jsdelivr.net/gh/dlagez/img@master/image-20220315102527410.png)

生成器 G 1 和 G 2 的目标是学习训练样本的分布。 它是通过使鉴别器预测每个生成样本的标签来实现的



N 发电机 G 1 和 G 2，四个 1-D 和 2-D 移调卷积层逐层堆叠。除最后一层外，所有转置卷积层都使用整流线性单元 (RELU) 作为非线性激活函数，其中使用了 tanh 函数。 为了提高生成器的稳定性，使用批量归一化策略 [47]

![image-20220315102909626](https://cdn.jsdelivr.net/gh/dlagez/img@master/image-20220315102909626.png)



![image-20220315103025204](https://cdn.jsdelivr.net/gh/dlagez/img@master/image-20220315103025204.png)

Construction of generators *G*1 and *G*2 in MSGAN, where spectra are generated throught G1 and spatial patches are generated through G2.



#### B. Joint Spatial–Spectral Feature Extraction and Classification Through D in MSGAN

在鉴别器 D 中，输入包含训练样本和生成的样本。生成器用来提取联合空间光谱特征和分类高光谱图像。具体来说，空间光谱特征被1D-CNN从空间Xspe和G1（z1，y）提取。通过2D-CNN从空间补丁`Xspa and G2(Z2,y)`中提取空间特征。

光谱特征和空间特征首先分别重塑为柱矢量；然后将两个矢量连接在一起，以获得联合的空间光谱特征。在提取联合空间光谱特征时，这些特征用于进行分类。然而，经典`GAN`方法中的判别器只区分输入是否是真正的样本。为了解决高光谱图像中的多分类问题，在鉴别器中添加了`soft-max`分类层。因此，可以从鉴别器中获得类概率。相应地，多分类的新型对抗性客观函数定义如下，其中lD和lG分别是鉴别器和生成器的客观函数，D（·）代表鉴别器的输出，l（·）表示交叉熵。



还没有看完。