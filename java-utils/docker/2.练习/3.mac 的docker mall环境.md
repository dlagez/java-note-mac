mysql已经安装了，这里就不重新安装了。

### redis安装

```
docker pull redis:5
```

运行

```
docker run -p 6379:6379 --name redis -v /Volumes/roczhang/mydata/redis:/data -d redis:5 redis-server --appendonly yes
```

- --appendonly yes 持久化选项

```console
// 这个是官方的命令，没有使用挂载
docker run --name some-redis -d redis redis-server --appendonly yes
```

### nginx安装

我已经下载过了最新版，这里就不重新下载了。

```
docker pull nginx:1.10
```

```
docker run -p 80:80 --name nginx -v /Volumes/roczhang/mydata/nginx/html:/usr/share/nginx/html -v /Volumes/roczhang/mydata/nginx/logs:/var/log/nginx -d nginx
```

### rabbitmq安装	

```
docker pull rabbitmq:3.7.15
```

```
docker run -p 5672:5672 -p 15672:15672 --name rabbitmq -d rabbitmq:3.7.15
```

进入容器并管理功能

```
docker exec -it rabbitmq /bin/bash
rabbitmq-plugins enable rabbitmq_management
```

```
roczhang@roczhang-mac nginx % docker exec -it rabbitmq /bin/bash
root@69d85f48e0e3:/# rabbitmq-plugins enable rabbitmq_management
Enabling plugins on node rabbit@69d85f48e0e3:
rabbitmq_management
The following plugins have been configured:
  rabbitmq_management
  rabbitmq_management_agent
  rabbitmq_web_dispatch
Applying plugin configuration to rabbit@69d85f48e0e3...
The following plugins have been enabled:
  rabbitmq_management
  rabbitmq_management_agent
  rabbitmq_web_dispatch

started 3 plugins.
```

添加用户roczhang 密码password

添加virtual hosts mall

给roczhang添加mall

### elasticsearch安装

由于没有mall指定的版本

下载elasticsearch出了点小问题，pull elasticsearch的时候必须指定版本号

ref：https://github.com/elastic/elasticsearch-docker/issues/215

```
docker pull elasticsearch:7.14.1
```

```
// 会报错
docker run -p 9200:9200 -p 9300:9300 --name elasticsearch -e "discovery.type=single-node" -e "cluster.name=elasticsearch"  -it elasticsearch:7.14.1
```

```console
docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:7.14.1
```

进入容器

```
docker exec -it elasticsearch /bin/bash
```

下载插件

```
elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.14.1/elasticsearch-analysis-ik-7.14.1.zip
```

### Logstash安装

```
docker pull logstash:7.14.1
```

启动容器

```
docker run --name logstash -p 4560:4560 -p 4562:4562 -p 4563:4563 --link elasticsearch:es -v /Volumes/roczhang/mydata/logstash/logstash.conf:/usr/share/logstash/pipeline/logstash.conf -d logstash:7.14.1 
```

进入容器并安装插件

```
docker exec -it logstash /bin/bash
```

