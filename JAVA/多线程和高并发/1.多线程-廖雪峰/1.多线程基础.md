cpu执行代码是一条一条执行的，即使是单核cpu也可以同时运行多个任务，因为操作系统执行多任务就是让cpu对多个线程轮流交替执行。

即使是多核CPU，因为通常任务的数量远远多于CPU的核数，所以任务也是交替执行的。

### 进程：

我们把一个任务称为一个进行，浏览器就是一个进程。

### 线程：

进程内可以同时执行多个子任务，子任务成为线程。

```bash
                        ┌──────────┐
                        │Process   │
                        │┌────────┐│
            ┌──────────┐││ Thread ││┌──────────┐
            │Process   ││└────────┘││Process   │
            │┌────────┐││┌────────┐││┌────────┐│
┌──────────┐││ Thread ││││ Thread ││││ Thread ││
│Process   ││└────────┘││└────────┘││└────────┘│
│┌────────┐││┌────────┐││┌────────┐││┌────────┐│
││ Thread ││││ Thread ││││ Thread ││││ Thread ││
│└────────┘││└────────┘││└────────┘││└────────┘│
└──────────┘└──────────┘└──────────┘└──────────┘
┌──────────────────────────────────────────────┐
│               Operating System               │
└──────────────────────────────────────────────┘
```

线程的调度由操作系统完成。程序不能决定自己什么时候执行。

### 实现多任务的方法：

多进程模式（每个进程只有一个线程）：

```ascii
┌──────────┐ ┌──────────┐ ┌──────────┐
│Process   │ │Process   │ │Process   │
│┌────────┐│ │┌────────┐│ │┌────────┐│
││ Thread ││ ││ Thread ││ ││ Thread ││
│└────────┘│ │└────────┘│ │└────────┘│
└──────────┘ └──────────┘ └──────────┘
```

多线程模式（一个进程有多个线程）：

```ascii
┌────────────────────┐
│Process             │
│┌────────┐┌────────┐│
││ Thread ││ Thread ││
│└────────┘└────────┘│
│┌────────┐┌────────┐│
││ Thread ││ Thread ││
│└────────┘└────────┘│
└────────────────────┘
```

多进程＋多线程模式（复杂度最高）：

```ascii
┌──────────┐┌──────────┐┌──────────┐
│Process   ││Process   ││Process   │
│┌────────┐││┌────────┐││┌────────┐│
││ Thread ││││ Thread ││││ Thread ││
│└────────┘││└────────┘││└────────┘│
│┌────────┐││┌────────┐││┌────────┐│
││ Thread ││││ Thread ││││ Thread ││
│└────────┘││└────────┘││└────────┘│
└──────────┘└──────────┘└──────────┘
```

### 进程 vs 线程

多进程缺点：

- 创建进程比创建线程开销大，尤其是win系统
- 进程间通信比线程间通信要慢，线程的通信就是读写统一变量。

多进程优点：

- 多进程稳定性比多线程高，在多进程的情况下，一个进程的崩溃不会影响其他进程
- 多线程的情况下，一个线程的崩溃会直接导致进程的崩溃

### 多线程：

java程序实际上就是一个JVM进程，JVM进程用一个主线程来执行main() 方法，在main方法内部我们可以启动多个线程。JVM还负责垃圾回收和其他工作线程等。

对于java来说，多任务的实现就是：如何使用多线程实现多任务。

#### 多线程的特点在于：

- 多线程经常需要读写共享变量，并且需要同步。
- 多线程模型是java程序最基本的并发模型