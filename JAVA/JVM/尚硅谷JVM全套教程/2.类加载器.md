https://www.bilibili.com/video/BV1PJ411n7xZ?p=32&spm_id_from=pageDriver

## JVM两种类加载器：

- 引导类加载器（Bootstrap ClassLoader）
- 自定义类加载器（User-Defined ClassLoader）

从概念上讲，自定义类加载器一般指的是程序中由开发人员自定义的一类加载器，但是Java虚拟机规范却没有这么定义，而是**将所有派生于抽象类ClassLoader的类加载器都划分为自定义类加载器。**

常见的类加载器的类型有如下3个：

- 引导类加载器（加载Java的核心类库）
- 拓展类加载器
- 系统类加载器

![image-20210815201851583](2.%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8.assets/image-20210815201851583.png)

获取extClassLoader，systemClassLoader的代码，引导类加载器boostrapClassLoader它有可能获取不到

```java
package JVM;

public class ClassLoaderTest {
    public static void main(String[] args) {
        ClassLoader systemClassLoader = ClassLoader.getSystemClassLoader();
        System.out.println("systemClassLoader: " + systemClassLoader);

        ClassLoader extClassLoader = systemClassLoader.getParent();
        System.out.println("extClassLoader:" + extClassLoader);

        ClassLoader boostrapClassLoader = extClassLoader.getParent();
        System.out.println("boostrapClassLoader: " + boostrapClassLoader);
		
        ClassLoader classLoader = ClassLoaderTest.class.getClassLoader();
        System.out.println("classLoader: " + classLoader);
        
        ClassLoader StringClassLoader = String.class.getClassLoader();
        System.out.println("StringClassLoader: " + StringClassLoader);
    }
}

output:
systemClassLoader: jdk.internal.loader.ClassLoaders$AppClassLoader@3d4eac69
extClassLoader:jdk.internal.loader.ClassLoaders$PlatformClassLoader@6ce253f1
boostrapClassLoader: null
classLoader: jdk.internal.loader.ClassLoaders$AppClassLoader@3d4eac69
    // 说明当前类是由systemClassLoader加载的（默认）
StringClassLoader: null
    // 说明String类是由boostrapClassLoader引导类加载器
```

### 虚拟机自带的加载器：

启动类加载器（引导类加载器，BootStrap ClassLoader）

- 这个类加载使用C/C++语言实现，嵌套在JVM内部
- 它用来加载Java核心库，（JAVA_HOME/jre/lib/rt.jar、resourves.jar或sun.boot.class.path路径下的内容），用于提供JVM自身需要的类。
- 并不继承自java.lang.ClassLoader,没有父加载器。
- 加载拓展类和应用程序类加载器（又名：系统类加载器），并指定为他们的父类加载器。
- 处于安全考虑，Bootstrap启动类加载器只加载包名为java、javax、sun等开头的类。

拓展类加载器（Extension ClassLoader）

- java语言编写，由sun.misc.Launcher&ExtClassLoader实现。
- 派生于ClassLoader类
- 父类加载器为启动类加载器
- 主要识别jre/lib/ext文件夹下的类库。用户创建的jar放在此目录下，也会自动由拓展类

应用程序类加载器：

- java语言编写，由sun.misc.Launcher$AppClassLoader实现
- 派生于ClassLoader类
- 父类加载器为拓展类加载器
- 它负责加载环境变量classpath或系统属性 java.class.path指定路径下的类库
- **该类加载是程序中默认的类加载器**， 一般来说，Java应用的类都是由它来加载。
- 通过ClassLoader#getSystemClassLoader()方法可以获取到该类加载器。

用户自定义类加载器

在Java的日常开发中，类加载器几乎是由上述3种类加载器相互配合执行的，用户也可以自定义类加载器

### ClassLoader

classLoader类，它是一个抽象类，其后所有的类加载器都继承自ClassLoader(不包括启动类加载器)

![image-20210816003627495](2.%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8.assets/image-20210816003627495.png)

ExtClassLoader, AppClassLoader 都间接继承自ClassLoader



获取ClassLoader

- clazz.getClassLoader()
- Thread,currentThread().getContextClassLoader()  // 和当前类加载器一样
- ClassLoader.getSystemClassLoader()
- DriverManaget.getCallerClassLoader()

